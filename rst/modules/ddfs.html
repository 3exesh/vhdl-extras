
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>ddfs &#8212; VHDL-extras 1.0 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/project.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="fifos" href="fifos.html" />
    <link rel="prev" title="crc_ops" href="crc_ops.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="ddfs">
<h1>ddfs<a class="headerlink" href="#ddfs" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://github.com/kevinpt/vhdl-extras/blob/master/rtl/extras/ddfs.vhdl">extras/ddfs.vhdl</a></p>
<div class="section" id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="sizing.html"><span class="doc">sizing</span></a>
<a class="reference internal" href="arithmetic.html"><span class="doc">arithmetic</span></a></p>
</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This package provides a set of functions and a component used for
implementing a Direct Digital Frequency Synthesizer (DDFS). The DDFS
component is a simple accumulator that increments by a pre computed value
each cycle. The MSB of the accumulator switches at the requested frequency
established by the <a class="reference internal" href="#extras.ddfs_pkg.ddfs_increment[real,real,natural return unsigned]" title="extras.ddfs_pkg.ddfs_increment[real,real,natural return unsigned]"><code class="xref vhdl vhdl-func docutils literal"><span class="pre">ddfs_increment()</span></code></a> function. The provided functions perform
computations with real values and, as such, are only synthesizable when
used to define constants.</p>
<p>There are two sets of functions for generating the increment values needed
by the DDFS accumulator. One set is used to compute static increments that
are assigned to constants. The other functions work in conjunction with a
procedure to dynamically generate the increment value using a single
inferred multiplier.</p>
<p>It is possible to generate multiple frequencies by computing more than one
increment constant and multiplexing between them. The <a class="reference internal" href="#extras.ddfs_pkg.ddfs_size[real,real,real return natural]" title="extras.ddfs_pkg.ddfs_size[real,real,real return natural]"><code class="xref vhdl vhdl-func docutils literal"><span class="pre">ddfs_size()</span></code></a> function
should be called with the smallest target frequency to be used to
guarantee the requested tolerance is met. You can alternately set a fixed size and compute the
effective tolerance with <a class="reference internal" href="#extras.ddfs_pkg.ddfs_tolerance[real,real,natural return real]" title="extras.ddfs_pkg.ddfs_tolerance[real,real,natural return real]"><code class="xref vhdl vhdl-func docutils literal"><span class="pre">ddfs_tolerance()</span></code></a>.</p>
<p>For simulation reporting, you can compute the effective output frequency with the <a class="reference internal" href="#extras.ddfs_pkg.ddfs_frequency[real,real,natural return real]" title="extras.ddfs_pkg.ddfs_frequency[real,real,natural return real]"><code class="xref vhdl vhdl-func docutils literal"><span class="pre">ddfs_frequency()</span></code></a> function and the error ratio
with <a class="reference internal" href="#extras.ddfs_pkg.ddfs_error[real,real,natural return real]" title="extras.ddfs_pkg.ddfs_error[real,real,natural return real]"><code class="xref vhdl vhdl-func docutils literal"><span class="pre">ddfs_error()</span></code></a>.</p>
<p>The utility function <a class="reference internal" href="#extras.ddfs_pkg.resize_fractional[unsigned,positive return unsigned]" title="extras.ddfs_pkg.resize_fractional[unsigned,positive return unsigned]"><code class="xref vhdl vhdl-func docutils literal"><span class="pre">resize_fractional()</span></code></a> will truncate unwanted LSBs when downsizing the generated DDFS accumulator value.</p>
<div class="section" id="example-usage">
<h3>Example usage<a class="headerlink" href="#example-usage" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#extras.ddfs_pkg.ddfs_size[real,real,real return natural]" title="extras.ddfs_pkg.ddfs_size[real,real,real return natural]"><code class="xref vhdl vhdl-func docutils literal"><span class="pre">ddfs_size()</span></code></a> and <a class="reference internal" href="#extras.ddfs_pkg.ddfs_increment[real,real,natural return unsigned]" title="extras.ddfs_pkg.ddfs_increment[real,real,natural return unsigned]"><code class="xref vhdl vhdl-func docutils literal"><span class="pre">ddfs_increment()</span></code></a>
functions are used to compute static increment values:</p>
<div class="highlight-vhdl"><div class="highlight"><pre><span class="k">constant</span> <span class="n">SYS_FREQ</span>  <span class="o">:</span> <span class="n">real</span>    <span class="o">:=</span> <span class="mi">50</span><span class="p">.</span><span class="mi">0</span><span class="n">e6</span><span class="p">;</span> <span class="c1">-- 50 MHz</span>
<span class="k">constant</span> <span class="n">TGT_FREQ</span>  <span class="o">:</span> <span class="n">real</span>    <span class="o">:=</span> <span class="mi">2600</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span> <span class="c1">-- 2600 Hz</span>
<span class="k">constant</span> <span class="n">DDFS_TOL</span>  <span class="o">:</span> <span class="n">real</span>    <span class="o">:=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span><span class="p">;</span>  <span class="c1">-- 0.1%</span>
<span class="k">constant</span> <span class="n">SIZE</span>      <span class="o">:</span> <span class="kt">natural</span> <span class="o">:=</span> <span class="n">ddfs_size</span><span class="p">(</span><span class="n">SYS_FREQ</span><span class="p">,</span> <span class="n">TGT_FREQ</span><span class="p">,</span> <span class="n">DDFS_TOL</span><span class="p">);</span>
<span class="k">constant</span> <span class="n">INCREMENT</span> <span class="o">:</span> <span class="n">unsigned</span><span class="p">(</span><span class="n">SIZE</span><span class="o">-</span><span class="mi">1</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">)</span> <span class="o">:=</span>
                             <span class="n">ddfs_increment</span><span class="p">(</span><span class="n">SYS_FREQ</span><span class="p">,</span> <span class="n">TGT_FREQ</span><span class="p">,</span> <span class="n">SIZE</span><span class="p">);</span>
<span class="p">...</span>
<span class="n">whistle</span><span class="o">:</span> <span class="n">ddfs</span>
  <span class="k">port</span> <span class="k">map</span> <span class="p">(</span>
    <span class="n">Clock</span> <span class="o">=&gt;</span> <span class="n">clock</span><span class="p">,</span>
    <span class="n">Reset</span> <span class="o">=&gt;</span> <span class="n">reset</span><span class="p">,</span>

    <span class="n">Enable</span>     <span class="o">=&gt;</span> <span class="sc">&#39;1&#39;</span><span class="p">,</span>
    <span class="n">Load_phase</span> <span class="o">=&gt;</span> <span class="sc">&#39;0&#39;</span><span class="p">,</span>
    <span class="n">New_phase</span>  <span class="o">=&gt;</span> <span class="n">unsigned</span><span class="p">&#39;</span><span class="s">&quot;&quot;</span><span class="p">,</span>

    <span class="n">Increment</span>   <span class="o">=&gt;</span> <span class="n">INCREMENT</span><span class="p">,</span>
    <span class="n">Accumulator</span> <span class="o">=&gt;</span> <span class="n">accum</span><span class="p">,</span>
    <span class="n">Synth_clock</span> <span class="o">=&gt;</span> <span class="n">synth_tone</span><span class="p">,</span> <span class="c1">-- Signal with ~2600 Hz clock</span>
    <span class="n">Synth_pulse</span> <span class="o">=&gt;</span> <span class="k">open</span>
  <span class="p">);</span>
<span class="p">...</span>
<span class="c1">-- Report the DDFS precision (simulation only)</span>
<span class="n">report</span> <span class="s">&quot;True synthesized frequency: &quot;</span>
  <span class="o">&amp;</span> <span class="n">real</span><span class="na">&#39;image</span><span class="p">(</span><span class="n">ddfs_frequency</span><span class="p">(</span><span class="n">SYS_FREQ</span><span class="p">,</span> <span class="n">TGT_FREQ</span><span class="p">,</span> <span class="n">SIZE</span><span class="p">)</span>
<span class="n">report</span> <span class="s">&quot;DDFS error: &quot;</span> <span class="o">&amp;</span> <span class="n">real</span><span class="na">&#39;image</span><span class="p">(</span><span class="n">ddfs_error</span><span class="p">(</span><span class="n">SYS_FREQ</span><span class="p">,</span> <span class="n">TGT_FREQ</span><span class="p">,</span> <span class="n">SIZE</span><span class="p">)</span>
</pre></div>
</div>
<p>The alternate set of functions <a class="reference internal" href="#extras.ddfs_pkg.min_fraction_bits[real,real,natural,real return natural]" title="extras.ddfs_pkg.min_fraction_bits[real,real,natural,real return natural]"><code class="xref vhdl vhdl-func docutils literal"><span class="pre">min_fraction_bits()</span></code></a>,
<a class="reference internal" href="#extras.ddfs_pkg.ddfs_dynamic_factor[real,natural,natural return natural]" title="extras.ddfs_pkg.ddfs_dynamic_factor[real,natural,natural return natural]"><code class="xref vhdl vhdl-func docutils literal"><span class="pre">ddfs_dynamic_factor()</span></code></a>, and <a class="reference internal" href="#extras.ddfs_pkg.ddfs_dynamic_inc[natural,natural,unsigned,unsigned]" title="extras.ddfs_pkg.ddfs_dynamic_inc[natural,natural,unsigned,unsigned]"><code class="xref vhdl vhdl-func docutils literal"><span class="pre">ddfs_dynamic_inc()</span></code></a> are used to precompute a multiplier factor
that is used to dynamically generate an increment value in synthesizable logic:</p>
<div class="highlight-vhdl"><div class="highlight"><pre><span class="k">constant</span> <span class="n">MIN_TGT_FREQ</span> <span class="o">:</span> <span class="kt">natural</span> <span class="o">:=</span> <span class="mi">27</span><span class="p">;</span>
<span class="k">constant</span> <span class="n">MAX_TGT_FREQ</span> <span class="o">:</span> <span class="kt">natural</span> <span class="o">:=</span> <span class="mi">4200</span><span class="p">;</span>
<span class="k">constant</span> <span class="n">FRAC_BITS</span>    <span class="o">:</span> <span class="kt">natural</span> <span class="o">:=</span> <span class="n">min_fraction_bits</span><span class="p">(</span><span class="n">SYS_FREQ</span><span class="p">,</span>
                                      <span class="n">MIN_TGT_FREQ</span><span class="p">,</span> <span class="n">SIZE</span><span class="p">,</span> <span class="n">DDFS_TOL</span><span class="p">);</span>
<span class="k">constant</span> <span class="n">DDFS_FACTOR</span>  <span class="o">:</span> <span class="kt">natural</span> <span class="o">:=</span> <span class="n">ddfs_dynamic_factor</span><span class="p">(</span><span class="n">SYS_FREQ</span><span class="p">,</span> <span class="n">SIZE</span><span class="p">,</span>
                                                       <span class="n">FRAC_BITS</span><span class="p">);</span>
<span class="k">signal</span> <span class="n">dyn_freq</span> <span class="o">:</span> <span class="n">unsigned</span><span class="p">(</span><span class="n">bit_size</span><span class="p">(</span><span class="n">MAX_TGT_FREQ</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">signal</span> <span class="n">dyn_inc</span>  <span class="o">:</span> <span class="n">unsigned</span><span class="p">(</span><span class="n">SIZE</span><span class="o">-</span><span class="mi">1</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">...</span>
<span class="n">dyn_freq</span> <span class="o">&lt;=</span> <span class="n">to_unsigned</span><span class="p">(</span><span class="mi">261</span><span class="p">,</span> <span class="n">dyn_freq</span><span class="na">&#39;length</span><span class="p">);</span> <span class="c1">-- Middle C</span>
<span class="p">...</span>
<span class="n">dyn_freq</span> <span class="o">&lt;=</span> <span class="n">to_unsigned</span><span class="p">(</span><span class="mi">440</span><span class="p">,</span> <span class="n">dyn_freq</span><span class="na">&#39;length</span><span class="p">);</span> <span class="c1">-- Change to A4</span>
<span class="p">...</span>
<span class="c1">-- Wrap ddfs_dynamic_inc in a sequencial process to synthesize a</span>
<span class="c1">-- multiplier with registered product.</span>
<span class="n">dyn</span><span class="o">:</span> <span class="k">process</span><span class="p">(</span><span class="n">clock</span><span class="p">,</span> <span class="n">reset</span><span class="p">)</span> <span class="k">is</span>
<span class="k">begin</span>
  <span class="k">if</span> <span class="n">reset</span> <span class="o">=</span> <span class="sc">&#39;1&#39;</span> <span class="k">then</span>
    <span class="n">dyn_inc</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="k">others</span> <span class="o">=&gt;</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>
  <span class="k">elsif</span> <span class="n">rising_edge</span><span class="p">(</span><span class="n">clock</span><span class="p">)</span> <span class="k">then</span>
    <span class="n">ddfs_dynamic_inc</span><span class="p">(</span><span class="n">DDFS_FACTOR</span><span class="p">,</span> <span class="n">FRAC_BITS</span><span class="p">,</span> <span class="n">dyn_freq</span><span class="p">,</span> <span class="n">dyn_inc</span><span class="p">);</span>
  <span class="k">end</span> <span class="k">if</span><span class="p">;</span>
<span class="k">end</span> <span class="k">process</span><span class="p">;</span>

<span class="n">fsynth</span><span class="o">:</span> <span class="n">ddfs</span>
  <span class="k">port</span> <span class="k">map</span> <span class="p">(</span>
    <span class="n">Clock</span> <span class="o">=&gt;</span> <span class="n">clock</span><span class="p">,</span>
    <span class="n">Reset</span> <span class="o">=&gt;</span> <span class="n">reset</span><span class="p">,</span>

    <span class="n">Enable</span>     <span class="o">=&gt;</span> <span class="sc">&#39;1&#39;</span><span class="p">,</span>
    <span class="n">Load_phase</span> <span class="o">=&gt;</span> <span class="sc">&#39;0&#39;</span><span class="p">,</span>
    <span class="n">New_phase</span>  <span class="o">=&gt;</span> <span class="n">unsigned</span><span class="p">&#39;</span><span class="s">&quot;&quot;</span><span class="p">,</span>

    <span class="n">Increment</span>   <span class="o">=&gt;</span> <span class="n">dyn_inc</span><span class="p">,</span>
    <span class="n">Accumulator</span> <span class="o">=&gt;</span> <span class="n">accum</span><span class="p">,</span>
    <span class="n">Synth_clock</span> <span class="o">=&gt;</span> <span class="n">synth_tone</span><span class="p">,</span>
    <span class="n">Synth_pulse</span> <span class="o">=&gt;</span> <span class="k">open</span>
  <span class="p">);</span>
</pre></div>
</div>
<span class="target" id="package-extras.ddfs_pkg"></span></div>
</div>
<div class="section" id="components">
<h2>Components<a class="headerlink" href="#components" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>ddfs<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<object data="../../_images/symbol-ddfs_pkg-ddfs.svg" type="image/svg+xml">
            <p class="warning">component ddfs is
generic (
  RESET_ACTIVE_LEVEL : std_ulogic
);
port (
  --# {{clocks|}}
  Clock : in std_ulogic;
  Reset : in std_ulogic;
  --# {{control|}}
  Enable : in std_ulogic;
  Load_phase : in std_ulogic;
  New_phase : in unsigned;
  Increment : in unsigned;
  --# {{data|}}
  Accumulator : out unsigned;
  Synth_clock : out std_ulogic;
  Synth_pulse : out std_ulogic
);
end component;</p></object>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="entity">
<dt id="extras.ddfs_pkg.ddfs">
<code class="descclassname">ddfs_pkg.</code><code class="descname">ddfs</code><a class="headerlink" href="#extras.ddfs_pkg.ddfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Synthesize a frequency using a DDFS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Generics:</th><td class="field-body"><ul class="first simple">
<li><strong>RESET_ACTIVE_LEVEL</strong> (<em>std_ulogic</em>) – Asynch. reset control level</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Port:</th><td class="field-body"><ul class="first last simple">
<li><strong>Clock</strong> (<em>in std_ulogic</em>) – System clock</li>
<li><strong>Reset</strong> (<em>in std_ulogic</em>) – Asynchronous reset</li>
<li><strong>Enable</strong> (<em>in std_ulogic</em>) – Enable the DDFS counter</li>
<li><strong>Load_phase</strong> (<em>in std_ulogic</em>) – Load a new phase angle</li>
<li><strong>New_phase</strong> (<em>in unsigned</em>) – Phase angle to load</li>
<li><strong>Increment</strong> (<em>in unsigned</em>) – Value controlling the synthesized frequency</li>
<li><strong>Accumulator</strong> (<em>out unsigned</em>) – Internal accumulator value</li>
<li><strong>Synth_clock</strong> (<em>out std_ulogic</em>) – Synthesized frequency</li>
<li><strong>Synth_pulse</strong> (<em>out std_ulogic</em>) – Single cycle pulse for rising edge of synth_clock</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="ddfs-pipelined">
<h3>ddfs_pipelined<a class="headerlink" href="#ddfs-pipelined" title="Permalink to this headline">¶</a></h3>
<object data="../../_images/symbol-ddfs_pkg-ddfs_pipelined.svg" type="image/svg+xml">
            <p class="warning">component ddfs_pipelined is
generic (
  MAX_CARRY_LENGTH : positive;
  RESET_ACTIVE_LEVEL : std_ulogic
);
port (
  --# {{clocks|}}
  Clock : in std_ulogic;
  Reset : in std_ulogic;
  --# {{control|}}
  Enable : in std_ulogic;
  Load_phase : in std_ulogic;
  New_phase : in unsigned;
  Increment : in unsigned;
  --# {{data|}}
  Accumulator : out unsigned;
  Synth_clock : out std_ulogic;
  Synth_pulse : out std_ulogic
);
end component;</p></object>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="entity">
<dt id="extras.ddfs_pkg.ddfs_pipelined">
<code class="descclassname">ddfs_pkg.</code><code class="descname">ddfs_pipelined</code><a class="headerlink" href="#extras.ddfs_pkg.ddfs_pipelined" title="Permalink to this definition">¶</a></dt>
<dd><p>Synthesize a frequency using a DDFS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Generics:</th><td class="field-body"><ul class="first simple">
<li><strong>MAX_CARRY_LENGTH</strong> (<em>positive</em>) – </li>
<li><strong>RESET_ACTIVE_LEVEL</strong> (<em>std_ulogic</em>) – Asynch. reset control level</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Port:</th><td class="field-body"><ul class="first last simple">
<li><strong>Clock</strong> (<em>in std_ulogic</em>) – System clock</li>
<li><strong>Reset</strong> (<em>in std_ulogic</em>) – Asynchronous reset</li>
<li><strong>Enable</strong> (<em>in std_ulogic</em>) – Enable the DDFS counter</li>
<li><strong>Load_phase</strong> (<em>in std_ulogic</em>) – Load a new phase angle</li>
<li><strong>New_phase</strong> (<em>in unsigned</em>) – Phase angle to load</li>
<li><strong>Increment</strong> (<em>in unsigned</em>) – Value controlling the synthesized frequency</li>
<li><strong>Accumulator</strong> (<em>out unsigned</em>) – Internal accumulator value</li>
<li><strong>Synth_clock</strong> (<em>out std_ulogic</em>) – Synthesized frequency</li>
<li><strong>Synth_pulse</strong> (<em>out std_ulogic</em>) – Single cycle pulse for rising edge of synth_clock</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="subprograms">
<h2>Subprograms<a class="headerlink" href="#subprograms" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="extras.ddfs_pkg.ddfs_size[real,real,real return natural]">
<code class="descclassname">ddfs_pkg.</code><code class="descname">ddfs_size</code> <span class="sig-paren">(</span><em>Sys_freq : real</em>; <em>Target_freq : real</em>; <em>Tolerance : real</em><span class="sig-paren">)</span> &#x2192; natural<a class="headerlink" href="#extras.ddfs_pkg.ddfs_size[real,real,real return natural]" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Compute the necessary size of a DDFS accumulator based on system and
target frequencies with a specified tolerance. The DDFS accumulator
must be at least as large as the result to achieve the requested tolerance.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Sys_freq</strong> (<em>real</em>) – Clock frequency of the system</li>
<li><strong>Target_freq</strong> (<em>real</em>) – Desired frequency to generate</li>
<li><strong>Tolerance</strong> (<em>real</em>) – Error tolerance</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Number of bits needed to generate the target frequency within the allowed tolerance.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="extras.ddfs_pkg.ddfs_tolerance[real,real,natural return real]">
<code class="descclassname">ddfs_pkg.</code><code class="descname">ddfs_tolerance</code> <span class="sig-paren">(</span><em>Sys_freq : real</em>; <em>Target_freq : real</em>; <em>Size : natural</em><span class="sig-paren">)</span> &#x2192; real<a class="headerlink" href="#extras.ddfs_pkg.ddfs_tolerance[real,real,natural return real]" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Compute the effective frequency tolerance for a specific size and target
frequency.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Sys_freq</strong> (<em>real</em>) – Clock frequency of the system</li>
<li><strong>Target_freq</strong> (<em>real</em>) – Desired frequency to generate</li>
<li><strong>Size</strong> (<em>natural</em>) – Size of the DDFS counter</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Tolerance for the target frequency with a Size counter.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="extras.ddfs_pkg.ddfs_increment[real,real,natural return natural]">
<code class="descclassname">ddfs_pkg.</code><code class="descname">ddfs_increment</code> <span class="sig-paren">(</span><em>Sys_freq : real</em>; <em>Target_freq : real</em>; <em>Size : natural</em><span class="sig-paren">)</span> &#x2192; natural<a class="headerlink" href="#extras.ddfs_pkg.ddfs_increment[real,real,natural return natural]" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Compute the natural increment value needed to generate a target frequency.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Sys_freq</strong> (<em>real</em>) – Clock frequency of the system</li>
<li><strong>Target_freq</strong> (<em>real</em>) – Desired frequency to generate</li>
<li><strong>Size</strong> (<em>natural</em>) – Size of the DDFS counter</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Increment value needed to generate the target frequency.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="extras.ddfs_pkg.ddfs_increment[real,real,natural return unsigned]">
<code class="descclassname">ddfs_pkg.</code><code class="descname">ddfs_increment</code> <span class="sig-paren">(</span><em>Sys_freq : real</em>; <em>Target_freq : real</em>; <em>Size : natural</em><span class="sig-paren">)</span> &#x2192; unsigned<a class="headerlink" href="#extras.ddfs_pkg.ddfs_increment[real,real,natural return unsigned]" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Compute the unsigned increment value needed to generate a target frequency.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Sys_freq</strong> (<em>real</em>) – Clock frequency of the system</li>
<li><strong>Target_freq</strong> (<em>real</em>) – Desired frequency to generate</li>
<li><strong>Size</strong> (<em>natural</em>) – Size of the DDFS counter</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Increment value needed to generate the target frequency.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="extras.ddfs_pkg.min_fraction_bits[real,real,natural,real return natural]">
<code class="descclassname">ddfs_pkg.</code><code class="descname">min_fraction_bits</code> <span class="sig-paren">(</span><em>Sys_freq : real</em>; <em>Target_freq : real</em>; <em>Size : natural</em>; <em>Tolerance : real</em><span class="sig-paren">)</span> &#x2192; natural<a class="headerlink" href="#extras.ddfs_pkg.min_fraction_bits[real,real,natural,real return natural]" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Find the minimum number of fraction bits needed to meet
the tolerance requirement for a dynamic DDFS. The target
frequency should be the lowest frequency to ensure proper
results.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Sys_freq</strong> (<em>real</em>) – Clock frequency of the system</li>
<li><strong>Target_freq</strong> (<em>real</em>) – Lowest desired frequency to generate</li>
<li><strong>Size</strong> (<em>natural</em>) – Size of the DDFS counter</li>
<li><strong>Tolerance</strong> (<em>real</em>) – Error tolerance</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Increment value needed to generate the target frequency.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="extras.ddfs_pkg.ddfs_dynamic_factor[real,natural,natural return natural]">
<code class="descclassname">ddfs_pkg.</code><code class="descname">ddfs_dynamic_factor</code> <span class="sig-paren">(</span><em>Sys_freq : real</em>; <em>Size : natural</em>; <em>Fraction_bits : natural</em><span class="sig-paren">)</span> &#x2192; natural<a class="headerlink" href="#extras.ddfs_pkg.ddfs_dynamic_factor[real,natural,natural return natural]" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Compute the factor used to generate dynamic increment values.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Sys_freq</strong> (<em>real</em>) – Clock frequency of the system</li>
<li><strong>Size</strong> (<em>natural</em>) – Size of the DDFS counter</li>
<li><strong>Fraction_bits</strong> (<em>natural</em>) – Number of fraction bits</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Dynamic increment factor passed into ddfs_dynamic_inc().</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="procedure">
<dt id="extras.ddfs_pkg.ddfs_dynamic_inc[natural,natural,unsigned,unsigned]">
<code class="descclassname">ddfs_pkg.</code><code class="descname">ddfs_dynamic_inc</code> <span class="sig-paren">(</span><em>Dynamic_factor : in natural</em>; <em>Fraction_bits : in natural</em>; <em>Target_freq : in unsigned</em>; <em>Increment : out unsigned</em><span class="sig-paren">)</span><a class="headerlink" href="#extras.ddfs_pkg.ddfs_dynamic_inc[natural,natural,unsigned,unsigned]" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>This procedure computes dynamic increment values by multiplying
the result of a previous call to ddfs_dynamic_factor by the
integer target frequency. The result is an integer value with
fractional bits removed.
This can be synthesized by invocation within a synchronous
process.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Dynamic_factor</strong> (<em>in natural</em>) – Dynamic factor constant</li>
<li><strong>Fraction_bits</strong> (<em>in natural</em>) – Fraction bits for the dynamic DDFS</li>
<li><strong>Target_freq</strong> (<em>in unsigned</em>) – Desired frequency to generate</li>
<li><strong>Increment</strong> (<em>out unsigned</em>) – Increment value needed to generate the target frequency.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="extras.ddfs_pkg.ddfs_frequency[real,real,natural return real]">
<code class="descclassname">ddfs_pkg.</code><code class="descname">ddfs_frequency</code> <span class="sig-paren">(</span><em>Sys_freq : real</em>; <em>Target_freq : real</em>; <em>Size : natural</em><span class="sig-paren">)</span> &#x2192; real<a class="headerlink" href="#extras.ddfs_pkg.ddfs_frequency[real,real,natural return real]" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Compute the actual synthesized frequency for the specified accumulator
size.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Sys_freq</strong> (<em>real</em>) – Clock frequency of the system</li>
<li><strong>Target_freq</strong> (<em>real</em>) – Desired frequency to generate</li>
<li><strong>Size</strong> (<em>natural</em>) – Size of the DDFS counter</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Frequency generated with the provided parameters.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="extras.ddfs_pkg.ddfs_error[real,real,natural return real]">
<code class="descclassname">ddfs_pkg.</code><code class="descname">ddfs_error</code> <span class="sig-paren">(</span><em>Sys_freq : real</em>; <em>Target_freq : real</em>; <em>Size : natural</em><span class="sig-paren">)</span> &#x2192; real<a class="headerlink" href="#extras.ddfs_pkg.ddfs_error[real,real,natural return real]" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Compute the error between the requested output frequency and the actual
output frequency.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Sys_freq</strong> (<em>real</em>) – Clock frequency of the system</li>
<li><strong>Target_freq</strong> (<em>real</em>) – Desired frequency to generate</li>
<li><strong>Size</strong> (<em>natural</em>) – Size of the DDFS counter</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Ratio of generated frequency to target frequency.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="extras.ddfs_pkg.resize_fractional[unsigned,positive return unsigned]">
<code class="descclassname">ddfs_pkg.</code><code class="descname">resize_fractional</code> <span class="sig-paren">(</span><em>Phase : unsigned</em>; <em>Size : positive</em><span class="sig-paren">)</span> &#x2192; unsigned<a class="headerlink" href="#extras.ddfs_pkg.resize_fractional[unsigned,positive return unsigned]" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Resize a vector representing a fractional value with the binary point
preceeding the MSB.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Phase</strong> (<em>unsigned</em>) – Phase angle in range 0.0 to 1.0.</li>
<li><strong>Size</strong> (<em>positive</em>) – Number of bits in the result</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Resized vector containing phase fraction</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="extras.ddfs_pkg.radians_to_phase[real,positive return unsigned]">
<code class="descclassname">ddfs_pkg.</code><code class="descname">radians_to_phase</code> <span class="sig-paren">(</span><em>Radians : real</em>; <em>Size : positive</em><span class="sig-paren">)</span> &#x2192; unsigned<a class="headerlink" href="#extras.ddfs_pkg.radians_to_phase[real,positive return unsigned]" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Convert angle in radians to a fractional phase value.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Radians</strong> (<em>real</em>) – Angle to convert</li>
<li><strong>Size</strong> (<em>positive</em>) – Number of bits in the result</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Fraction phase in range 0.0 to 1.0.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="extras.ddfs_pkg.degrees_to_phase[real,positive return unsigned]">
<code class="descclassname">ddfs_pkg.</code><code class="descname">degrees_to_phase</code> <span class="sig-paren">(</span><em>Degrees : real</em>; <em>Size : positive</em><span class="sig-paren">)</span> &#x2192; unsigned<a class="headerlink" href="#extras.ddfs_pkg.degrees_to_phase[real,positive return unsigned]" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Convert angle in degrees to a fractional phase value.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Degrees</strong> (<em>real</em>) – Angle to convert</li>
<li><strong>Size</strong> (<em>positive</em>) – Number of bits in the result</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Fraction phase in range 0.0 to 1.0.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/vhdl-extras-sm.png" alt="Logo"/>
            </a></p>
<!--<h1 class="logo"><a href="../../index.html">VHDL-extras</a></h1>-->



<p class="blurb">Flexible VHDL library</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=kevinpt&repo=vhdl-extras&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>



<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="crc_ops.html" title="previous chapter">crc_ops</a></li>
      <li>Next: <a href="fifos.html" title="next chapter">fifos</a></li>
  </ul></li>
</ul>
</div>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">ddfs</a><ul>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li><a class="reference internal" href="#description">Description</a><ul>
<li><a class="reference internal" href="#example-usage">Example usage</a></li>
</ul>
</li>
<li><a class="reference internal" href="#components">Components</a><ul>
<li><a class="reference internal" href="#id1">ddfs</a></li>
<li><a class="reference internal" href="#ddfs-pipelined">ddfs_pipelined</a></li>
</ul>
</li>
<li><a class="reference internal" href="#subprograms">Subprograms</a></li>
</ul>
</li>
</ul>
<h3>Other projects</h3>

<div id="proj_list">
<p>
<a href="http://kevinpt.github.io/opbasm/">Opbasm</a><br>
<a href="http://kevinpt.github.io/ripyl/">Ripyl</a><br>
<a href="http://code.google.com/p/vertcl">Vertcl</a><br>

<a href="http://kevinpt.github.io/lecroy-colorizer/">Lecroy-colorizer</a>
</p>
</div>

<script>
$(function() { // Retrieve list of repositories from Github and dynamically insert them into sidebar

if(!window.sessionStorage || !JSON) { return; } // Punt on crusty browsers (looking at you IE10)

function JSONP( url, callback ) {
	var id = ( 'jsonp' + Math.random() * new Date() ).replace('.', '');
	var script = document.createElement('script');
	script.src = url.replace( 'callback=?', 'callback=' + id );
	document.body.appendChild( script );
	window[ id ] = function( data ) {
		if (callback) {
			callback( data );
		}
	};
}

function insert_projects(projects) {
    var links = [];
    var cur_proj = "VHDL-extras".toLowerCase();
    $.each(projects, function(key, value) {
      if(key != cur_proj) {
        var title = key.replace(/^./, function(match) {return match.toUpperCase()}); // Capitalize first char
        links.push("<a href='"+ value +"'>" + title + "</a>");
      }
    });
    
    $("#proj_list").html("<p>"+ links.join("<br>") +"</p>");
}

var now = new Date().getTime();
if(sessionStorage.KTcacheTime && now - sessionStorage.KTcacheTime < 5*60*1000 ) { // Use cached values (5 min. expiry)
  insert_projects(JSON.parse(sessionStorage.KTprojects));
} else { // Retrieve current projects
  JSONP("https://api.github.com/users/kevinpt/repos?type=owner&callback=?", function(response) {
    var projects = {};
    $.each(response.data, function(index, value) {
      projects[value.name] = value.homepage;
    });
    
    insert_projects(projects);
    
    // Store data in session cache
    sessionStorage.KTprojects = JSON.stringify(projects);
    var now = new Date().getTime();
    sessionStorage.KTcacheTime = now;
  });  
}

});
</script>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <div class="footer">
      &copy;2017, Kevin Thibedeau.
      
      |
      <a href="../../_sources/rst/modules/ddfs.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    


  </body>
</html>